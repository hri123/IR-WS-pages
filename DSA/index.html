<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="downloaded/bootstrap-3.3.6-dist/css/bootstrap.css"></link>
  <script src="downloaded/jquery-1.12.3.js"></script>
  <script src="downloaded/bootstrap-3.3.6-dist/js/bootstrap.js"></script>
  <style>

  </style>

  <script>
    function addPanel(panelId, panelName) {
      $('#add-panel-here').append("<div class='col-md-4' id=" + panelId + "><div class='container panel panel-default col-md-12'><div class='panel-heading row'><h4 class='panel-title col-md-12'>" + panelName +
        "</h4></div><ul class='list-group'></ul></div></div>");
    }

    function addSource(panelId, filename, description, highlight) {

      var html = "<li class='row list-group-item'><div class='col-sm-11'>" + description + "</div>";

      if (filename && filename != "") {
        html += "<div class='col-sm-1'><a href='showcode.html?filename=" + filename + "&highlight=" + highlight + "'>" + '(' + highlight + ')' + "</a><a href='showcode.html?filename=" + filename + "&highlight=" + 'html' + "'>" + '(html)' + "</a></div></li>";
      }

      $('#' + panelId).find('ul').append(html);
    }

    $(document).ready(function() {

      // these json files are like the index files of the database
      // the database consists of all the files mentioned in the json file
      var dataFile = "source/panelDetails.json";

      // 'async': false, -> Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user's experience. For more help, check https://xhr.spec.whatwg.org/.
      // var json = (function() {
      //   var json = null;
      //   $.ajax({
      //     'async': false,
      //     'global': false,
      //     'url': dataFile,
      //     'dataType': "json",
      //     'success': function(data) {
      //       json = data;
      //     }
      //   });
      //   return json;
      // })();

      $.ajax({
        'async': true,
        'global': false,
        'url': dataFile,
        'dataType': "json"
      }).done(function(data) {

        var json = data;
        $.each(json.panels, function(i, panel) {

          var panelId = 'panel' + i;

          var panelName = panel.panelName;

          addPanel(panelId, panelName);

          $.each(panel.sources, function(i, source) {

            var filename = source.filename;

            var description = source.description;
            // if description is an array, concatenate
            if (Array.isArray(description)) {
              description = description.join(' ');
            }

            var highlight = source.highlight;

            addSource(panelId, filename, description, highlight);
          });

        });
      }).fail(function() {

        alert('loading data from json failed');
      });


    });
  </script>
</head>

<body>

  <nav class="navbar navbar-default">

  </nav>

  <div id="add-panel-here" class="container-fluid">
  </div>

</body>

</html>
